import{a as re}from"./chunk-REETW534.js";import{a as te,b as E,c as T,d as ie}from"./chunk-5BYDZPPU.js";import{a as ee}from"./chunk-3ERC74S6.js";import{Ea as Y,F as a,Fa as G,Ga as K,I as B,N as c,Na as Q,O as x,Oa as Z,Q as O,R as k,S as w,T as q,U as e,V as t,W as C,_ as D,aa as g,ca as p,e as R,f as V,g as z,ia as H,ja as J,l as X,la as n,ma as _,na as y,oa as W,p as $,s as d,t as b,u,ua as U,va as S,wa as P,xa as h,y as v}from"./chunk-F66V2PF3.js";var L=class r{xpService=d(E);myWordsRepository=d(T);getSummary(){return{totalXp:this.xpService.getXp(),savedWordsCount:this.myWordsRepository.getAll().length}}static \u0275fac=function(i){return new(i||r)};static \u0275prov=$({token:r,factory:r.\u0275fac,providedIn:"root"})};var se=r=>["/video",r],le=(r,o)=>o.ts,de=(r,o)=>o.lessonId,me=(r,o)=>o.type;function pe(r,o){if(r&1){let i=D();e(0,"div",22)(1,"button",39),g("click",function(){b(i);let l=p();return u(l.copyAll())}),e(2,"span",40),n(3,"content_copy"),t()(),e(4,"button",41),g("click",function(){b(i);let l=p();return u(l.confirmClear())}),e(5,"span",40),n(6,"delete"),t()()()}}function ce(r,o){r&1&&(e(0,"div",24)(1,"span",42),n(2,"book"),t(),e(3,"p",43),n(4,"No words saved yet"),t(),e(5,"p",44),n(6,"Words you add during lessons will appear here."),t()())}function xe(r,o){if(r&1&&(e(0,"span",45),n(1),t()),r&2){let i=o.$implicit;a(),y(" ",i," ")}}function ge(r,o){if(r&1&&(e(0,"span",46),n(1),t()),r&2){let i=p(2);a(),y(" +",i.savedWords().length-10," more ")}}function fe(r,o){if(r&1&&(e(0,"div",25),k(1,xe,2,1,"span",45,O),c(3,ge,2,1,"span",46),t()),r&2){let i=p();a(),w(i.previewWords()),a(2),x(i.savedWords().length>10?3:-1)}}function be(r,o){if(r&1&&(e(0,"div",30)(1,"div",47)(2,"p",48),n(3),t(),e(4,"p",49),n(5),S(6,"date"),t()(),e(7,"div",50),n(8),t()()),r&2){let i=o.$implicit;a(3),_(i.reason),a(2),_(P(6,3,i.ts,"MMM d, HH:mm")),a(3),y(" +",i.amount," ")}}function ue(r,o){r&1&&(e(0,"div",31)(1,"p",51),n(2,"No activity yet"),t()())}function ve(r,o){r&1&&(e(0,"div",36),C(1,"div",52),e(2,"p",53),n(3,"Loading progress data..."),t()())}function ye(r,o){r&1&&(e(0,"span",68),n(1,"check_circle"),t())}function _e(r,o){if(r&1&&(e(0,"span",69),n(1),S(2,"number"),t()),r&2){let i=p().$implicit;a(),y("",P(2,1,i.percent,"1.0-0"),"%")}}function he(r,o){if(r&1&&(e(0,"div",64)(1,"span",65),n(2),t(),C(3,"span",66),e(4,"span",67),n(5),t(),c(6,ye,2,0,"span",68)(7,_e,3,4,"span",69),t()),r&2){let i=o.$implicit;a(2),_(i.label),a(3),W("",i.completed,"/",i.total),a(),x(i.percent===100?6:7)}}function ke(r,o){if(r&1&&(e(0,"div",54)(1,"div",55)(2,"div",47)(3,"a",56),n(4),e(5,"span",57),n(6,"open_in_new"),t()()(),e(7,"div",58)(8,"div",59)(9,"span",60),n(10),t(),e(11,"span",61),n(12),S(13,"number"),t()()()(),e(14,"div",62),C(15,"div",63),t(),e(16,"div",25),k(17,he,8,4,"div",64,me),t()()),r&2){let i=o.$implicit;a(3),q("routerLink",U(14,se,i.lessonId)),a(),y(" ",i.title," "),a(6),W(" ",i.completedExercises,"/",i.totalExercises," "),a(2),y(" (",P(13,11,i.percent,"1.0-0"),"%) "),a(3),H("width",i.percent,"%"),J("bg-green-500",i.percent>0)("shadow-[0_0_12px_rgba(34,197,94,0",i.percent===100),a(2),w(i.byType)}}function we(r,o){r&1&&(e(0,"div",24)(1,"span",42),n(2,"history_edu"),t(),e(3,"p",43),n(4,"No lessons available"),t(),e(5,"p",44),n(6,"Complete lessons in the catalog to see your progress here."),t()())}function Ce(r,o){if(r&1&&k(0,ke,19,16,"div",54,de,!1,we,7,0,"div",24),r&2){let i=p();w(i.lessonProgress())}}function Se(r,o){if(r&1){let i=D();e(0,"div",70),g("click",function(){b(i);let l=p();return u(l.showClearModal.set(!1))}),e(1,"div",71),g("click",function(l){return b(i),u(l.stopPropagation())}),e(2,"div",72)(3,"span",12),n(4,"delete_forever"),t()(),e(5,"h3",73),n(6,"Clear all words?"),t(),e(7,"p",74),n(8,"This action cannot be undone. All your saved vocabulary will be removed."),t(),e(9,"div",75)(10,"button",76),g("click",function(){b(i);let l=p();return u(l.clearAll())}),n(11," Yes, clear all "),t(),e(12,"button",77),g("click",function(){b(i);let l=p();return u(l.showClearModal.set(!1))}),n(13," Cancel "),t()()()()}}function Pe(r,o){r&1&&(e(0,"div",38)(1,"div",78)(2,"span",79),n(3,"check_circle"),t(),e(4,"span",80),n(5,"Copied to clipboard!"),t()()())}var Ee={word_translation_mcq:"Word",sentence_translation_mcq:"Sentence",comprehension_mcq:"Context",fill_blank:"Fill-in"},ne=class r{summaryService=d(L);myWordsRepository=d(T);xpService=d(E);userProgressService=d(ie);exerciseProgressService=d(te);lessonsService=d(ee);exerciseDataService=d(re);router=d(Q);refreshTrigger=v(0);allLessons=v([]);lessonTotals=v({});isLoadingTotals=v(!0);showClearModal=v(!1);showCopyToast=v(!1);ngOnInit(){this.loadLessonData()}loadLessonData(){this.lessonsService.getAllLessons().pipe(X(o=>{if(this.allLessons.set(o),o.length===0)return R([]);let i=o.map(s=>this.exerciseDataService.getExercisesForLesson(s.id).pipe(V(l=>({id:s.id,data:l}))));return z(i)})).subscribe(o=>{let i={};o.forEach(s=>{i[s.id]=s.data}),this.lessonTotals.set(i),this.isLoadingTotals.set(!1)})}lessonProgress=h(()=>{let o=this.allLessons(),i=this.lessonTotals(),s=this.exerciseProgressService.getAttempts();return o.map(l=>{let j=i[l.id];if(!j)return null;let M=j.exerciseSets.map(m=>{let f=m.items.length,N=m.items.filter(oe=>s.some(A=>A.exerciseId===oe.id&&A.isCorrect)).length;return{type:m.type,label:Ee[m.type]||m.type,total:f,completed:N,percent:f>0?N/f*100:0}}).filter(m=>m.total>0),I=M.reduce((m,f)=>m+f.total,0),F=M.reduce((m,f)=>m+f.completed,0);return{lessonId:l.id,title:l.title,totalExercises:I,completedExercises:F,percent:I>0?F/I*100:0,byType:M}}).filter(l=>l!==null)});savedWords=h(()=>(this.refreshTrigger(),this.myWordsRepository.getAll()));previewWords=h(()=>this.savedWords().slice(0,10));summary=h(()=>(this.refreshTrigger(),this.summaryService.getSummary()));xpLog=h(()=>this.xpService.getLog().slice(0,10));continueLearning(){let o=this.userProgressService.lastLessonId();o?this.router.navigate(["/video",o]):this.router.navigate(["/catalog"])}copyAll(){let o=this.savedWords().join(", ");navigator.clipboard.writeText(o).then(()=>{this.showCopyToast.set(!0),setTimeout(()=>this.showCopyToast.set(!1),2e3)})}confirmClear(){this.showClearModal.set(!0)}clearAll(){this.myWordsRepository.clearAll(),this.refreshTrigger.update(o=>o+1),this.showClearModal.set(!1)}static \u0275fac=function(i){return new(i||r)};static \u0275cmp=B({type:r,selectors:[["app-progress-page"]],decls:70,vars:8,consts:[[1,"flex-1","overflow-y-auto","bg-[#fcfcf9]","dark:bg-[#0f0f05]","p-6","md:p-10"],[1,"max-w-6xl","mx-auto"],[1,"mb-10","flex","flex-col","md:flex-row","md:items-end","justify-between","gap-6"],[1,"text-3xl","font-bold","text-text-primary","dark:text-white"],[1,"text-text-secondary","dark:text-gray-400","mt-2"],[1,"flex","items-center","gap-3"],[1,"px-6","py-3","rounded-2xl","bg-primary","text-text-primary","font-bold","shadow-lg","shadow-primary/20","hover:bg-[#e6e205]","transition-all","flex","items-center","gap-2","cursor-pointer",3,"click"],[1,"material-symbols-outlined","font-bold"],["routerLink","/catalog",1,"px-6","py-3","rounded-2xl","bg-white","dark:bg-[#1e1e12]","border","border-[#f0f0eb]","dark:border-[#33332a]","text-text-primary","dark:text-white","font-bold","hover:bg-gray-50","dark:hover:bg-white/5","transition-all","flex","items-center","gap-2","cursor-pointer"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6","mb-12"],[1,"bg-white","dark:bg-[#1e1e12]","rounded-3xl","p-6","border","border-[#f0f0eb]","dark:border-[#33332a]","shadow-sm","flex","items-center","gap-5"],[1,"size-14","rounded-2xl","bg-primary/10","flex","items-center","justify-center","text-primary"],[1,"material-symbols-outlined","!text-[32px]"],[1,"text-sm","font-medium","text-text-secondary","dark:text-gray-400","uppercase","tracking-wider"],[1,"text-2xl","font-black","text-text-primary","dark:text-white"],[1,"size-14","rounded-2xl","bg-[#00a3ff]/10","flex","items-center","justify-center","text-[#00a3ff]"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-8"],[1,"lg:col-span-1","space-y-8"],[1,"bg-white","dark:bg-[#1e1e12]","rounded-3xl","border","border-[#f0f0eb]","dark:border-[#33332a]","shadow-sm","overflow-hidden"],[1,"px-6","py-5","border-b","border-[#f0f0eb]","dark:border-[#33332a]","flex","items-center","justify-between","bg-gray-50/50","dark:bg-white/5"],[1,"text-xl","font-bold","text-text-primary","dark:text-white","flex","items-center","gap-2"],[1,"material-symbols-outlined","text-primary"],[1,"flex","items-center","gap-2"],[1,"p-6"],[1,"py-12","flex","flex-col","items-center","justify-center","text-center"],[1,"flex","flex-wrap","gap-2"],[1,"bg-white","dark:bg-[#1e1e12]","rounded-3xl","border","border-[#f0f0eb]","dark:border-[#33332a]","shadow-sm","overflow-hidden","flex","flex-col"],[1,"px-6","py-5","border-b","border-[#f0f0eb]","dark:border-[#33332a]","bg-gray-50/50","dark:bg-white/5"],[1,"text-lg","font-bold","text-text-primary","dark:text-white","flex","items-center","gap-2"],[1,"p-4","space-y-3"],[1,"flex","items-center","justify-between","gap-4","p-3","rounded-2xl","bg-gray-50/50","dark:bg-white/5","border","border-[#f0f0eb]/50","dark:border-[#33332a]/50"],[1,"py-8","flex","flex-col","items-center","justify-center","text-center"],[1,"lg:col-span-2"],[1,"bg-white","dark:bg-[#1e1e12]","rounded-3xl","border","border-[#f0f0eb]","dark:border-[#33332a]","shadow-sm","overflow-hidden","h-full","flex","flex-col"],[1,"px-6","py-5","border-b","border-[#f0f0eb]","dark:border-[#33332a]","bg-gray-50/50","dark:bg-white/5","flex","items-center","justify-between"],[1,"flex-1","p-6","space-y-6"],[1,"flex","flex-col","items-center","justify-center","py-20","gap-4","text-text-secondary"],[1,"fixed","inset-0","z-[100]","flex","items-center","justify-center","p-4","bg-black/40","backdrop-blur-sm","animate-in","fade-in","duration-200"],[1,"fixed","bottom-8","left-1/2","-translate-x-1/2","z-[100]","animate-in","slide-in-from-bottom-4","fade-in","duration-300","pointer-events-none"],["title","Copy all words",1,"p-2","rounded-xl","text-text-primary","bg-white","dark:bg-[#2a2a1a]","border","border-[#e6e6e0]","dark:border-[#444]","hover:bg-gray-50","dark:hover:bg-[#333]","transition-colors","cursor-pointer",3,"click"],[1,"material-symbols-outlined","!text-[18px]"],["title","Clear all",1,"p-2","rounded-xl","text-red-500","bg-red-50","dark:bg-red-500/10","border","border-red-100","dark:border-red-500/20","hover:bg-red-100","dark:hover:bg-red-500/20","transition-colors","cursor-pointer",3,"click"],[1,"material-symbols-outlined","text-gray-200","dark:text-gray-700","!text-[64px]","mb-4"],[1,"text-text-primary","dark:text-white","font-bold","mb-1"],[1,"text-text-secondary","dark:text-gray-500","text-sm","max-w-xs"],[1,"px-3","py-1.5","rounded-xl","bg-[#f9f506]/10","text-text-primary","dark:text-white","text-sm","font-medium","border","border-[#f9f506]/20"],[1,"px-3","py-1.5","rounded-xl","bg-gray-50","dark:bg-[#25251a]","text-text-secondary","dark:text-gray-400","text-sm","font-medium","border","border-[#e6e6e0]","dark:border-[#33332a]"],[1,"min-w-0"],[1,"text-xs","font-bold","text-text-primary","dark:text-white","truncate"],[1,"text-[9px]","text-text-secondary","dark:text-gray-500","uppercase","font-medium"],[1,"flex","items-center","gap-0.5","text-green-600","dark:text-green-400","font-black","text-xs","shrink-0"],[1,"text-text-secondary","dark:text-gray-500","text-xs","font-medium"],[1,"size-10","border-4","border-primary/20","border-t-primary","rounded-full","animate-spin"],[1,"text-sm","font-medium"],[1,"p-5","rounded-[24px]","bg-gray-50/50","dark:bg-white/5","border","border-[#f0f0eb]","dark:border-[#33332a]","hover:border-primary/30","transition-all","group"],[1,"flex","flex-col","md:flex-row","md:items-center","justify-between","gap-4","mb-5"],[1,"text-lg","font-black","text-text-primary","dark:text-white","hover:text-primary","transition-colors","flex","items-center","gap-2",3,"routerLink"],[1,"material-symbols-outlined","!text-[18px]","opacity-0","group-hover:opacity-100","transition-opacity"],[1,"flex","items-center","gap-3","shrink-0"],[1,"text-right"],[1,"text-sm","font-black","text-text-primary","dark:text-white"],[1,"text-xs","font-medium","text-text-secondary","dark:text-gray-500","ml-1"],[1,"h-2","w-full","bg-gray-200/50","dark:bg-white/10","rounded-full","overflow-hidden","mb-5"],[1,"h-full","rounded-full","transition-all","duration-1000","ease-out"],[1,"flex","items-center","gap-2","px-3","py-1.5","rounded-xl","bg-white","dark:bg-[#1e1e12]","border","border-[#f0f0eb]","dark:border-[#33332a]","text-[11px]"],[1,"font-bold","text-text-secondary","dark:text-gray-400","uppercase","tracking-tight"],[1,"w-[1px]","h-3","bg-gray-200","dark:bg-gray-700"],[1,"font-black","text-text-primary","dark:text-white"],[1,"material-symbols-outlined","!text-[14px]","text-green-500","font-bold"],[1,"text-text-secondary","dark:text-gray-500","font-medium"],[1,"fixed","inset-0","z-[100]","flex","items-center","justify-center","p-4","bg-black/40","backdrop-blur-sm","animate-in","fade-in","duration-200",3,"click"],[1,"bg-white","dark:bg-[#1e1e12]","rounded-[32px]","p-8","w-full","max-w-sm","shadow-2xl","border","border-[#f0f0eb]","dark:border-[#33332a]","animate-in","zoom-in-95","duration-200",3,"click"],[1,"size-16","rounded-full","bg-red-50","dark:bg-red-500/10","flex","items-center","justify-center","text-red-500","mb-6","mx-auto"],[1,"text-xl","font-bold","text-text-primary","dark:text-white","text-center","mb-2"],[1,"text-text-secondary","dark:text-gray-400","text-center","mb-8","text-sm"],[1,"flex","flex-col","gap-3"],[1,"w-full","h-12","rounded-2xl","bg-red-500","text-white","font-bold","hover:bg-red-600","transition-colors","shadow-lg","shadow-red-500/20","cursor-pointer",3,"click"],[1,"w-full","h-12","rounded-2xl","bg-gray-50","dark:bg-[#2a2a1a]","text-text-primary","dark:text-white","font-bold","hover:bg-gray-100","dark:hover:bg-[#333]","transition-colors","cursor-pointer",3,"click"],[1,"bg-text-primary","dark:bg-white","text-white","dark:text-text-primary","px-6","py-3","rounded-2xl","shadow-2xl","flex","items-center","gap-3","border","border-white/10"],[1,"material-symbols-outlined","text-primary","!text-[20px]"],[1,"text-sm","font-bold","tracking-tight"]],template:function(i,s){i&1&&(e(0,"div",0)(1,"div",1)(2,"header",2)(3,"div")(4,"h1",3),n(5,"My Progress"),t(),e(6,"p",4),n(7,"Track your learning journey and saved words."),t()(),e(8,"div",5)(9,"button",6),g("click",function(){return s.continueLearning()}),e(10,"span",7),n(11,"play_circle"),t(),n(12," Continue Learning "),t(),e(13,"a",8)(14,"span",7),n(15,"grid_view"),t(),n(16," Catalog "),t()()(),e(17,"div",9)(18,"div",10)(19,"div",11)(20,"span",12),n(21,"bolt"),t()(),e(22,"div")(23,"p",13),n(24,"Total XP"),t(),e(25,"p",14),n(26),t()()(),e(27,"div",10)(28,"div",15)(29,"span",12),n(30,"menu_book"),t()(),e(31,"div")(32,"p",13),n(33,"Saved Words"),t(),e(34,"p",14),n(35),t()()()(),e(36,"div",16)(37,"div",17)(38,"section",18)(39,"div",19)(40,"h2",20)(41,"span",21),n(42,"bookmark"),t(),n(43," My Words "),t(),c(44,pe,7,0,"div",22),t(),e(45,"div",23),c(46,ce,7,0,"div",24)(47,fe,4,1,"div",25),t()(),e(48,"section",26)(49,"div",27)(50,"h2",28)(51,"span",21),n(52,"history"),t(),n(53," Recent Activity "),t()(),e(54,"div",29),k(55,be,9,6,"div",30,le,!1,ue,3,0,"div",31),t()()(),e(58,"div",32)(59,"section",33)(60,"div",34)(61,"h2",20)(62,"span",21),n(63,"analytics"),t(),n(64," Lesson Progress "),t()(),e(65,"div",35),c(66,ve,4,0,"div",36)(67,Ce,3,1),t()()()()()(),c(68,Se,14,0,"div",37),c(69,Pe,6,0,"div",38)),i&2&&(a(26),_(s.summary().totalXp.toLocaleString()),a(9),_(s.summary().savedWordsCount),a(9),x(s.savedWords().length>0?44:-1),a(2),x(s.savedWords().length===0?46:47),a(9),w(s.xpLog()),a(11),x(s.isLoadingTotals()?66:67),a(2),x(s.showClearModal()?68:-1),a(),x(s.showCopyToast()?69:-1))},dependencies:[K,Z,G,Y],styles:["[_nghost-%COMP%]{display:flex;flex:1;min-height:0}"]})};export{ne as ProgressPageComponent};
