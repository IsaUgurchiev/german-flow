import{p as n,y as i}from"./chunk-F66V2PF3.js";var l=class s{STORAGE_KEY="gf.exercise_attempts";attemptsSignal=i(this.loadFromStorage());loadFromStorage(){let t=localStorage.getItem(this.STORAGE_KEY);if(!t)return[];try{return JSON.parse(t)}catch{return[]}}saveAttempt(t){let e=this.attemptsSignal(),o=e.findIndex(a=>a.exerciseId===t.exerciseId),r;o!==-1?(r=[...e],r[o]=t):r=[...e,t],this.attemptsSignal.set(r),localStorage.setItem(this.STORAGE_KEY,JSON.stringify(r))}hydrate(t){t&&(this.attemptsSignal.set(t),localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t)))}getAttempts(){return this.attemptsSignal()}getAttempt(t){return this.attemptsSignal().find(e=>e.exerciseId===t)}isCompleted(t){return this.attemptsSignal().some(e=>e.exerciseId===t&&e.isCorrect)}static \u0275fac=function(e){return new(e||s)};static \u0275prov=n({token:s,factory:s.\u0275fac,providedIn:"root"})};var g=class s{STORAGE_KEY="gf.xp.total";LOG_KEY="gf.xp.log";totalXp=i(this.loadXp());xpLog=i(this.loadLog());getXp(){return this.totalXp()}getLog(){return this.xpLog()}addXp(t,e="Exercise completed"){if(t<=0)return;let o=Date.now();this.totalXp.update(r=>{let a=r+t;return this.saveXp(a),a}),this.xpLog.update(r=>{let d=[{ts:o,amount:t,reason:e},...r].slice(0,50);return this.saveLog(d),d})}loadXp(){let t=localStorage.getItem(this.STORAGE_KEY);if(!t)return 0;let e=parseInt(t,10);return isNaN(e)?0:e}saveXp(t){localStorage.setItem(this.STORAGE_KEY,t.toString())}loadLog(){let t=localStorage.getItem(this.LOG_KEY);if(!t)return[];try{let e=JSON.parse(t);return Array.isArray(e)?e:[]}catch{return[]}}saveLog(t){localStorage.setItem(this.LOG_KEY,JSON.stringify(t))}hydrate(t,e){this.totalXp.set(t),this.xpLog.set(e),this.saveXp(t),this.saveLog(e)}static \u0275fac=function(e){return new(e||s)};static \u0275prov=n({token:s,factory:s.\u0275fac,providedIn:"root"})};var p=class s{STORAGE_KEY="gf.words.saved";words=i(this.loadWords());getAll(){return this.words()}loadWords(){let t=localStorage.getItem(this.STORAGE_KEY);if(!t)return[];try{let e=JSON.parse(t);return Array.isArray(e)?e:[]}catch{return[]}}add(t){let e=this.words(),o=t.toLowerCase().trim();if(!e.includes(o)){let r=[...e,o];this.words.set(r),this.save(r)}}remove(t){let e=this.words(),o=t.toLowerCase().trim(),r=e.filter(a=>a!==o);r.length!==e.length&&(this.words.set(r),this.save(r))}isSaved(t){return this.words().includes(t.toLowerCase().trim())}clearAll(){this.words.set([]),localStorage.removeItem(this.STORAGE_KEY)}save(t){localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))}hydrate(t){this.words.set(t),this.save(t)}static \u0275fac=function(e){return new(e||s)};static \u0275prov=n({token:s,factory:s.\u0275fac,providedIn:"root"})};var m=class s{LAST_LESSON_KEY="gf.last.lessonId";lastLessonId=i(localStorage.getItem(this.LAST_LESSON_KEY));setLastLessonId(t){this.lastLessonId.set(t),localStorage.setItem(this.LAST_LESSON_KEY,t)}hydrate(t){t&&(this.lastLessonId.set(t),localStorage.setItem(this.LAST_LESSON_KEY,t))}static \u0275fac=function(e){return new(e||s)};static \u0275prov=n({token:s,factory:s.\u0275fac,providedIn:"root"})};export{l as a,g as b,p as c,m as d};
